{% liquid
  assign id = section.id
%}
{% liquid
  assign logo = section.settings.image
  assign logo_width = section.settings.logo_width
  assign logo_width_m = section.settings.logo_width_m
%}

{% assign allowed_templates = section.settings.template_names %}


<style>
  #shopify-section-{{id}} {
    box-sizing: border-box;
    margin-top: {{section.settings.margin_top | append: 'px'}};
    margin-bottom: {{section.settings.margin_bottom | append: 'px'}};
    padding-top: {{section.settings.padding_top | append: 'px'}};
    padding-bottom: {{section.settings.padding_bottom | append: 'px'}};
  }

  @media(max-width: 768px) {
    #shopify-section-{{id}} {
      margin-top: {{section.settings.margin_top_m | append: 'px'}};
      margin-bottom: {{section.settings.margin_bottom_m | append: 'px'}};
      padding-top: {{section.settings.padding_top_m | append: 'px'}};
      padding-bottom: {{section.settings.padding_bottom_m | append: 'px'}};
    }
  }
  .header__logo img{
    width: {{ logo_width | append: 'px' }};
  }
  .inverted_mbl-logo-all svg, .inverted_mbl-logo-all img, .inverted_mbl-logo-all h2{
    filter: invert(1);
  }
  @media screen and (min-width: 1201px){
    #shopify-section-{{id}} {
      position: fixed;
      top: 36px;
      left: 0;
      width: 100%;
      transition: top 0.3s ease;
    }
    {% comment %} .site__header{
      position: relative;
    }
    .site__header:after{
      position: absolute;
      content: "";
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(30,32,52,0.2);
      z-index: -1;
    } {% endcomment %}
  }
  @media screen and (max-width: 1200px){
    #shopify-section-{{id}} {
      top: unset !important;
    }
    #shopify-section-{{id}} .site__header{
      position: fixed;
      bottom: 10px;
      left: 0;
      width: 100%;
      z-index: 100;
      {% if template.name == 'product' %}
        opacity: 0;
        visibility: hidden;
        transition: all 0.4s;
      {% endif %}
    }
    {% comment %}
    #shopify-section-{{id}} .site__header.active{
      {% if template.name == 'product' %}
        display: block;
      {% endif %}
    }
    {% endcomment %}
    body.drawer-active .site__header{
      opacity: 1 !important;
      visibility: visible !important;
    }
    .site__header-wrapper{
      max-width: 370px;
      background: #000;
      padding-block: 10px;
      border-radius: 50px;
      @media screen and (max-width: 1200px) {
        backdrop-filter: blur(48px);
        -webkit-backdrop-filter: blur(48px);
        background: rgb(0 0 0 / 32%);
      }
    }
    .header__wrapper{
      justify-content: center !important;
    }
    .header__utility-icons{
      width: 100%;
    }
    .header__icons-wrapper {
      justify-content: space-between;
    }
    .header__icons-wrapper .header-icon{
      padding: 6px;
      color: #FFF;
    }
    .header__icons-wrapper .header-icon svg{
      width: 24px;
      height: 24px;
    }
    .burger-icon, .close-icon{
      display: none;
    }
    [mobile-drawer-opener] .burger-icon{
      display: block;
    }
    [mbl-drawer-close] .close-icon{
      display: block;
    }
    .close-search-mbl{
      opacity: 0;
      visibility: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      position: fixed;
      color: #000;
      top: 15px;
      right: 15px;
      font-size: 14px;
      text-transform: uppercase;
      font-weight: 600;
      z-index: 102;
      /* background-color: #000; */
      padding: 8px 16px;
      /* padding: 0; */
      border-radius: 9999px;
      /* color: #fff; */
      transition: all 0.6s ease-in-out;
    }
    .close-search-mbl.active{
      opacity: 1;
      visibility: visible;
    }
    .close-search-mbl.active svg path{
      stroke: #FFF;
    }
    .header__logo-sm{
      display: block;
      {% comment %} position: fixed;
      top: 50px;
      left: 50%;
      transform: translateX(-50%); {% endcomment %}
      position: static;
      z-index: 99;
    }
    .header__logo-sm svg{
      display: block;
      {% comment %} width: 50px; {% endcomment %}
      height: auto;
      {% comment %} filter: invert(1); {% endcomment %}
    }
    .header__logo-sm svg path{
      {% comment %} fill: #0C0C0C; {% endcomment %}
    }
    .header__logo-sm.inverted_mbl-logo svg {
      filter: invert(1);
    }
    .mbl__header-logo{
      display: block;
    }
    .mbl__header-logo svg{
      display: block;
      {% comment %} width: 50px; {% endcomment %}
      height: auto;
    }
    .mbl__header-logo svg path{
      fill: #000;
    }
    .new-header-cart-icon{
      position: relative;
    }
    span.cart__count {
      font-size: 8px;
      position: absolute;
      z-index: 11;
      top: -3px;
      left: 21px;
      width: 20px;
      height: 20px;
      {% comment %} padding: 5px; {% endcomment %}
      display: flex;
      align-items: center;
      justify-content: center;
      background: #000;
      color: #fff;
      border-radius: 50%;
    }
  }
</style>
{{ 'new-header-v1.css' | asset_url | stylesheet_tag }}

{% liquid
  assign allowed_invert = section.settings.invert_logo
  assign allowed_invert_all = section.settings.invert_logo_all
  assign current_suffix = request.path
  assign current_template = template.name

  assign allowed_invert_array = allowed_invert | split: ','
  assign is_match_found = false

  assign stripped_suffix = current_suffix | strip
  assign stripped_template = current_template | strip

  for item in allowed_invert_array
    assign stripped_item = item | strip
    if stripped_item == stripped_suffix or stripped_item == stripped_template
      assign is_match_found = true
      break
    endif
  endfor

  assign allowed_invert_all_array = allowed_invert_all | split: ','
  assign is_match_found_1 = false

  for item in allowed_invert_all_array
    assign stripped_item = item | strip
    if stripped_item == stripped_suffix or stripped_item == stripped_template
      assign is_match_found_1 = true
      break
    endif
  endfor
%}



<div
data-template="{{ template.name }}"
data-suffix="{{ request.path }}"
data-allowed="{{ allowed_templates }}"
class="sec-{{ id }} site__header">
  <div class="site__header-wrapper page-width">
    <div class="wrapper-{{ id }} sm-hide">
      <header class="header__wrapper">
        <div class="header__nav-logo">
          <a  class="{{  allowed_invert_all_array }} --- header__logo glass__bg invert__bg-hover-- 
            {% if is_match_found_1 %}
                inverted_mbl-logo-all
            {% endif %}
            " site-logo href="/">
            {% unless logo %}
              <h2>ZERO</h2>
            {% else %}
              <picture>
                <source media="(min-width: 744px)" srcset="{{ logo | image_url: width: logo_width }}">
                {{ logo | image_url: width: logo_width_m | image_tag: class: 'regular__logo', loading: 'lazy' }}
              </picture>
            {% endunless %}
          </a>
          {% if section.settings.menu != blank %}
            <div class="header__nav glass__bg sm-hide">
              <ul class="header__nav-ul">
                {% for link in section.settings.menu.links %}
                  {% assign has_mega_item = false %}
                  
                  {% for block in section.blocks %}
                    {% if block.type == 'mega-menu' %}
                      {% assign menu_title = block.settings.heading | handleize %}
                      {% assign title_handle = link.title | handleize %}
                      {% if menu_title == title_handle %}
                        {% assign has_mega_item = true %}
                        {% break %}
                      {% endif %}
                    {% endif %}
                  {% endfor %}

                  <li>
                    <a class="{% if has_mega_item or link.links != blank %}has__mega-menu{%  else %}no__mega-menu{% endif %}" data-menu="{{ link.title | handleize }}" href="{{ link.url }}">{{ link.title }}</a>
                  </li>
                {% endfor %}
              </ul>

            </div>
          {% endif %}
        </div>

        <div class="header__utility-icons glass__bg">
          <div class="header__icons-wrapper">
            <div class="header__currency glass__bg-- sm-hide hidden ">
              {% render 'currency-switcher' %}
            </div>
            <a
              href="#"
              class="header-icon glass__bg-- invert__bg-hover--"
              header-search
            >
              {%- render 'header-icons', name: 'search' -%}
              {% comment %} <span class="sm-hide">Search</span> {% endcomment %}
            </a>
            <div class="header__account glass__bg-- invert__bg-hover-- header__icon-wrapper">
              <a class="header__icon-item header-icon" account-drawer href="/account">
                {%- render 'header-icons', name: 'account' -%}
                {% comment %} <span class="sm-hide">Account</span> {% endcomment %}
                </a
              >
            </div>
            <a
              id="cart-icon-bubble"
              class="cart-icon-bubble new-header-cart-icon cart__counter-lg-- header-icon glass__bg-- invert__bg-hover--"
              cart-drawer
              href="{{ routes.cart_url }}"
            >
              {%- render 'header-icons', name: 'bag' -%}
              <span class="sm-hide">{% if cart != empty %}<span class="cart__count">{{ cart.item_count }}</span>{% endif %}</span>
              {% if cart != empty %}
                <span class="cart__count lg-hide">{{ cart.item_count }}</span>
              {% endif %}
            </a>
            <a class="glass__bg invert__bg-hover-- header-icon lg-hide mobile-drawer-open" mobile-drawer-opener href="#">MENU</a>
          </div>
        </div>
      </header>
    </div>
    <div class="wrapper-{{ id }} lg-hide">
      <header class="header__wrapper">
        <div class="header__utility-icons">
          <div class="header__icons-wrapper">
            <a
              href="#"
              class="header-icon glass__bg-"
              header-search
            >
              {%- render 'header-icons', name: 'search' -%}
              <span class="sm-hide">Search</span>
            </a>
            <a
              id="cart-icon-bubble-1"
              class="cart-icon-bubble new-header-cart-icon cart__counter-sm-- header-icon glass__bg-"
              cart-drawer
              href="{{ routes.cart_url }}"
            >
              {%- render 'header-icons', name: 'bag' -%}
              
              <span class="sm-hide">Cart{% if cart != empty %}<span class="cart__count">{{ cart.item_count }}</span>{% endif %}</span>
              {% if cart != empty %}
                <span class="cart__count lg-hide">{{ cart.item_count }}</span>
              {% endif %}
            </a>
            <div class="header__currency glass__bg- sm-hide">
              {% render 'currency-switcher' %}
            </div>
            {% comment %} <div class="header__account glass__bg- header__icon-wrapper">
              <a class="header__icon-item header-icon" account-drawer href="/account">
                {%- render 'header-icons', name: 'account' -%}
              </a>
            </div> {% endcomment %}
            <a class="glass__bg- header-icon lg-hide mobile-drawer-open pos-rel" mobile-drawer-opener href="#">
              <div class="burger__icon">
                <span></span>
                <span></span>
                <span></span>
              </div>
            </a>
          </div>
        </div>
      </header>
    </div>
  </div>
</div>
<div class="header-sticky-top lg-hide">
  <div class="header-sticky-top-wrapper">
    <a class="glass__bg header-icon lg-hide mobile-drawer-open pos-rel mobile-drawer-open-top" mobile-drawer-opener href="#">
      Menu
      {% comment %} <div class="burger__icon">
        <span></span>
        <span></span>
        <span></span>
      </div> {% endcomment %}
    </a>
    <a
      class="
        {% if is_match_found %}
          inverted_mbl-logo
        {% endif %}
        header__logo header__logo-sm lg-hide
        {% if is_match_found_1 %}
          inverted_mbl-logo-all
        {% endif %}
      "
      site-logo
      href="/"
    >
      {% render 'header-icons', name: 'zero' %}
      {% comment %}
        {% unless logo %}
          <h2>ZERO</h2>
        {% else %}
          <picture>
            <source media="(min-width: 744px)" srcset="{{ logo | image_url: width: logo_width }}">
            {{ logo | image_url: width: logo_width_m | image_tag: class: 'regular__logo', loading: 'lazy' }}
          </picture>
        {% endunless %}
      {% endcomment %}
    </a>
    <a
      id="cart-icon-bubble-2"
      class="cart-icon-bubble header-icon new-header-cart-icon new-header-cart-icon-top lg-hide glass__bg"
      cart-drawer
      href="{{ routes.cart_url }}"
    >
      <span class="cart__count-text">Cart </span>
      {% if cart != empty %}
        <span class="cart__count-pdp"> {{ cart.item_count }}</span>
      {% endif %}
    </a>
  </div>
</div>
{% render 'new-search', section: section %}
{% render 'new-mega-menu', section: section %}
{% render 'new-mobile-drawer-v1', section: section, logo: logo, logo_width: logo_width, logo_width_m: logo_width_m %}
<script src="{{ 'new-header-v1.js' | asset_url }}" defer="defer"></script>
{% schema %}
{
  "name": "New Header",
  "class": "header-section",
  "settings": [
    {
      "type": "header",
      "content": "Announcement Bar"
    },
    {
      "type": "color_background",
      "id": "background",
      "label": "Background"
    },
    {
      "type": "color",
      "id": "color",
      "label": "Text Color",
      "default": "#FFF"
    },
    {
      "type": "header",
      "content": "Logo"
    },
    {
      "type": "textarea",
      "id": "template_names",
      "label": "Template Names Where Top Spacing Nav Will not be Applied",
      "info": "Enter template names separated by commas (e.g., index,product,collection,cart)"
    },
    {
      "type": "image_picker",
      "id": "image",
      "label": "Logo Image"
    },
    {
      "type": "range",
      "id": "logo_width",
      "min": 0,
      "max": 200,
      "step": 5,
      "unit": "px",
      "label": "Logo Width",
      "default": 150
    },
    {
      "type": "range",
      "id": "logo_width_m",
      "min": 0,
      "max": 200,
      "step": 5,
      "unit": "px",
      "label": "Logo Width(Mobile)",
      "default": 150
    },
    {
      "type": "textarea",
      "id": "invert_logo",
      "label": "Template Names Where White Logo will be applied(Mobile)",
      "info": "Enter page handles separated by commas (e.g., index,product,collection,cart)"
    },
    {
      "type": "textarea",
      "id": "invert_logo_all",
      "label": "Template Names Where White Logo will be applied(In All Device)",
      "info": "Enter page handles separated by commas (e.g., index,product,collection,cart)"
    },
    {
      "type": "header",
      "content": "Navigation"
    },
    {
      "type": "link_list",
      "id": "menu",
      "label": "Menu"
    },
    {
      "type": "header",
      "content": "Section Spacing Desktop"
    },
    {
      "type": "range",
      "id": "margin_top",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "label": "Margin Top",
      "default": 24
    },
    {
      "type": "range",
      "id": "margin_bottom",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "label": "Margin Bottom",
      "default": 24
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "label": "Padding Top",
      "default": 0
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "label": "Padding Bottom",
      "default": 0
    },
    {
      "type": "header",
      "content": "Section Spacing Mobile"
    },
    {
      "type": "range",
      "id": "margin_top_m",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "label": "Margin Top",
      "default": 24
    },
    {
      "type": "range",
      "id": "margin_bottom_m",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "label": "Margin Bottom",
      "default": 24
    },
    {
      "type": "range",
      "id": "padding_top_m",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "label": "Padding Top",
      "default": 0
    },
    {
      "type": "range",
      "id": "padding_bottom_m",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "label": "Padding Bottom",
      "default": 0
    }
  ],
  "blocks": [
    {
      "type": "mega-menu",
      "name": "Mega Menu",
      "settings": [
        {
          "type": "text",
          "id": "heading",
          "label": "For item"
        },
        {
          "type": "header",
          "content": "Collection"
        },
        {
          "type": "text",
          "id": "title_1",
          "label": "Title"
        },
        {
          "type": "collection",
          "id": "collection_1",
          "label": "Collection"
        },
        {
          "type": "image_picker",
          "id": "image_1",
          "label": "Featured image"
        },
        {
          "type": "header",
          "content": "Collection"
        },
        {
          "type": "text",
          "id": "title_2",
          "label": "Title"
        },
        {
          "type": "collection",
          "id": "collection_2",
          "label": "Collection"
        },
        {
          "type": "image_picker",
          "id": "image_2",
          "label": "Featured image"
        },
        {
          "type": "header",
          "content": "Links"
        },
        {
          "type": "collection_list",
          "id": "collection_list",
          "label": "Collections",
          "limit": 8
        }
      ]
    },
    {
      "type": "content_mbl",
      "name": "Content Block Mobile",
      "settings": [
        {
          "type": "header",
          "content": "Content Block"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Title"
        },
        {
          "type": "url",
          "id": "link",
          "label": "Link"
        },
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "New Header"
    }
  ]
}
{% endschema %}
